@model IEnumerable<DCComics.Model.Person>
@{
    ViewBag.Title = "Index";
    Layout = null;
}


<div class="container-fluid">
    <div class="row">
        <h2 class="page-header2">
            Person
        </h2>

        <div class="panel panel-default" style="min-width:600px">
            <div class="panel-heading">
                Index
            </div>

            <div class="panel-body data-table panel-body-background">
                <div class="col-md-12">
                    @* I Changed to class from id for javascript reference *@
                    <table data-request-url="@Url.Action("Details", "Person")" data-table-request-url="@Url.Action("GetPeople", "Person")" data-modal-header="Person Details" class="results-table table table-striped table-bordered table-hover" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <th>@Html.DisplayNameFor(model => model.Id)</th>
                                <th>@Html.DisplayNameFor(model => model.FirstName)</th>
                                <th>@Html.DisplayNameFor(model => model.LastName)</th>
                                <th>@Html.DisplayNameFor(model => model.Address)</th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <div>
                    <button type="button" class="btn btn-success createNewButton" data-request-url="@Url.Action("Create", "Person")" data-modal-header="Create New Person">Create New Person</button>
                </div>
            </div>
        </div>
    </div>
</div>










<script type="text/javascript">
    //$(document).ready(function () {

        //I Changed $(".results-table")
        var table = $('.results-table').DataTable({
            ajax: {
                url: $('.results-table').data('table-request-url'),
                type: 'POST',
                dataSrc: "",
                //dataType: 'json',
                error: function (reponse) {
                    alert("error : " + reponse);
                }
            },
            columnDefs: [
            { className: "dt-head-center dt-body-right", "width": "40px", "targets": 0 },
            { className: "dt-head-center dt-body-center", "width": "80px", "targets": 1 },
            { className: "dt-head-center", "width": "150px", "targets": 2 },
            { className: "dt-head-center", "width": "200px", "targets": 3 }
            ],
            lengthMenu: [[10, 15, 20, 50, -1], [10, 15, 20, 50, "All"]],
            pageLength: 20,
            language: {
                search: "Filter:"
            },
            order: [[0, "desc"]],
            columns: [
                {
                    data: "Id",
                    visible: false
                },
                {
                    data: "FirstName",
                    visible: true,

                },
             {
                 data: "LastName",
                 visible: true
             },
              {
                  data: "Address",
                  visible: true
              }
            ]
        });


        //$(".createNewButton").on('click', function () {
        //    var headerText = $(this).data('modal-header');
        //    $.ajax({
        //        url: $(this).data('request-url'),
        //        type: 'GET',
        //        dataType: 'html',
        //        success: function (data) {
        //            $('#modalHeaderText').html(headerText);
        //            $('#popUpEntityPartialView').html(data);
        //            $('#popUpEntityView').modal('show');
        //        }
        //    });
        //});


        //$(".results-table tbody").on('click', 'tr', function () {

        //    var mydata = table.row(this).data();

        //    var headerText = $('.results-table').data('modal-header');
        //    $.ajax({
        //        url: $('.results-table').data('request-url'),
        //        type: 'GET',
        //        data: { 'id': mydata.Id },
        //        dataType: 'html',
        //        success: function (data) {
        //            $('#modalHeaderText').html(headerText);
        //            $('#popUpEntityPartialView').html(data);
        //            $('#popUpEntityView').modal('show');
        //        }
        //    });
        //});


        //OLD


        @*$("#createNewButton").on('click', function () {
            $.ajax({
                url: '@Url.Action("Create", "Person")',
                type: 'GET',
                dataType: 'html',
                success: function (data) {
                    $('#popUpCreatePartialView').html(data);
                    $('#popUpCreate').modal('show')
                }
            });
        });*@

        @*$("#person-results-table tbody").on('click', 'tr', function () {
            var mydata = table.row(this).data();
            //alert('You clicked on ' + data.FirstName + '\'s row');
            $.ajax({
                url: '@Url.Action("Details", "Person")',
                type: 'GET',
                data: { 'id': mydata.Id },
                dataType: 'html',
                success: function (data) {
                    $('#popUpTableItemPartialView').html(data);
                    $('#popUpTableItemView').modal('show')
                }
            });
        });*@


    //});
</script>

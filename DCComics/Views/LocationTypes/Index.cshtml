@model IEnumerable<DCComics.Model.Code_Tables.LocationType>

@{
    ViewBag.Title = "Index";
    Layout = null;
}

<h2>Index</h2>
<div class="container-fluid">

    <div class="row">
        
        <table data-request-url="@Url.Action("Details", "LocationTypes")" data-table-request-url="@Url.Action("GetLocationTypes", "LocationTypes")" data-modal-header="LocationTypes Details" class="results-table table table-striped table-bordered table-hover table-condensed" cellspacing="0">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.Id)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.LocationTypeCode)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.LocationTypeDesc)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.StartDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.EndDate)
                    </th>
                </tr>
            </thead>
        </table>
    </div>

    <div class="row">
        <div class="col-md-offset-6">
            <button type="button" class="btn btn-success createNewButton" data-request-url="@Url.Action("Create", "LocationTypes")" data-modal-header="Create New Location Types">Create New Location Type</button>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {

        var table = $(".results-table").DataTable({
            ajax: {
                url: $(".results-table").data('table-request-url'),
                type: 'POST',
                dataSrc: "",
                //dataType: 'json',
                error: function (reponse) {
                    alert("error : " + reponse);
                }
            },
            lengthMenu: [[10, 15, 20, 50, -1], [10, 15, 20, 50, "All"]],
            pageLength: 15,
            language: {
                search: "Filter:"
            },
            order: [[1, "asc"]],
            columns: [
                {
                    data: "Id",
                    visible: false
                },
                {
                    data: "LocationTypeCode",
                    visible: true,

                },
             {
                 data: "LocationTypeDesc",
                 visible: true
             },
              {
                  data: "StartDate",
                  visible: true
              },
              {
                  data: "EndDate",
                  visible: true
              }
            ]
        });

        //$(".createNewButton").on('click', function () {
        //    var headerText = $(this).data('modal-header');
        //    $.ajax({
        //        url: $(this).data('request-url'),
        //        type: 'GET',
        //        dataType: 'html',
        //        success: function (data) {
        //            $('#modalHeaderText').html(headerText);
        //            $('#popUpEntityPartialView').html(data);
        //            $('#popUpEntityView').modal('show');
        //        }
        //    });
        //});


        $(".results-table tbody").on('click', 'tr', function () {
            var mydata = table.row(this).data();
            var headerText = $('.results-table').data('modal-header');            
            $.ajax({
                url: $('.results-table').data('request-url'),
                type: 'GET',
                data: { 'id': mydata.Id },
                dataType: 'html',
                success: function (data) {
                    $('#modalHeaderText').html(headerText);
                    $('#popUpEntityPartialView').html(data);
                    $('#popUpEntityView').modal('show');
                }
            });
        });

    });
</script>
